"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7108],{1866:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var i=t(62540),s=t(43023);const r={description:"You can now integrate TeamForge-Git with Slack and have notifications about certain Gerrit events posted to a Slack channel.",id:"scm-gerrit-slack-integration",keywords:["integrations","slack","git","gerrit"],lastUpdatedAt:"Jun 29, 2021",product:"teamforge",tags:["ctf_21.1","git_gerrit"],title:"Set up Git\u2014Slack Integration"},a=void 0,c={id:"scm-gerrit-slack-integration",title:"Set up Git\u2014Slack Integration",description:"You can now integrate TeamForge-Git with Slack and have notifications about certain Gerrit events posted to a Slack channel.",source:"@site/../docs/scm-gerrit-slack-integration.md",sourceDirName:".",slug:"/scm-gerrit-slack-integration",permalink:"/teamforge/docs/next/scm-gerrit-slack-integration",draft:!1,unlisted:!1,tags:[{inline:!0,label:"ctf_21.1",permalink:"/teamforge/docs/next/tags/ctf-21-1"},{inline:!0,label:"git_gerrit",permalink:"/teamforge/docs/next/tags/git-gerrit"}],version:"current",lastUpdatedAt:1721042912e3,frontMatter:{description:"You can now integrate TeamForge-Git with Slack and have notifications about certain Gerrit events posted to a Slack channel.",id:"scm-gerrit-slack-integration",keywords:["integrations","slack","git","gerrit"],lastUpdatedAt:"Jun 29, 2021",product:"teamforge",tags:["ctf_21.1","git_gerrit"],title:"Set up Git\u2014Slack Integration"},sidebar:"docs",previous:{title:"Set up Git Replica Servers",permalink:"/teamforge/docs/next/setupgitreplica"},next:{title:"Set up LFS",permalink:"/teamforge/docs/next/setuplfs"}},o={},d=[{value:"Create a Slack App and Webhook URL",id:"create-a-slack-app-and-webhook-url",level:2},{value:"Configure the Slack Integration Gerrit Plugin",id:"configure-the-slack-integration-gerrit-plugin",level:2},{value:"Points to Consider",id:"points-to-consider",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Gerrit has a plugin that lets you publish certain Gerrit events to a Slack channel. For more information, see ",(0,i.jsx)(n.a,{href:"https://gerrit.googlesource.com/plugins/slack-integration/",children:"Gerrit's Slack Integration Plugin documentation"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://gerrit.googlesource.com/plugins/slack-integration/#installation",children:"Install the Gerrit's Slack Integration Plugin"})," and do the following to publish Gerrit events to a Slack channel:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a Slack App and Webhook URL"}),"\n",(0,i.jsx)(n.li,{children:"Configure the Slack Integration Gerrit Plugin with the Webhook URL"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Let us go through these procedures step-by-step."}),"\n",(0,i.jsx)(n.h2,{id:"create-a-slack-app-and-webhook-url",children:"Create a Slack App and Webhook URL"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Log on to your ",(0,i.jsx)(n.a,{href:"http://my.slack.com/",children:"Slack account"}),". Skip this step if you are logged on already."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(72976).A+"",width:"3557",height:"913"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(44267).A+"",width:"3576",height:"1546"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(23138).A+"",width:"3584",height:"1388"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(27389).A+"",width:"3550",height:"1168"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://api.slack.com/apps/new",children:"Create a Slack App"}),". Skip this step if you already have an app and want to use that to integrate with Gerrit."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(44531).A+"",width:"3574",height:"1112"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(70040).A+"",width:"3580",height:"1570"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(54657).A+"",width:"3584",height:"1698"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://api.slack.com/apps",children:"Go to the Slack Apps List page"})," and click the Gerrit app."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(44222).A+"",width:"3578",height:"962"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Select ",(0,i.jsx)(n.strong,{children:"Basic Information"})," from the ",(0,i.jsx)(n.strong,{children:"Settings"})," pane on the left. Click ",(0,i.jsx)(n.strong,{children:"Add Features and Functionality"})," to expand the pane."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(46325).A+"",width:"3584",height:"1484"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Incoming Webhooks"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(94060).A+"",width:"3584",height:"1872"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click the ",(0,i.jsx)(n.strong,{children:"Activate Incoming Webhooks"})," toggle button to turn it on."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(70307).A+"",width:"3584",height:"1170"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(6202).A+"",width:"3584",height:"1222"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"Add New Webhook to Workspace"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(77406).A+"",width:"3584",height:"2112"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Select the Slack channel where you want your Gerrit notifications posted and click ",(0,i.jsx)(n.strong,{children:"Allow"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(44757).A+"",width:"3578",height:"1230"})}),"\n",(0,i.jsx)(n.p,{children:"A success message appears in your Slack channel."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(59308).A+"",width:"2892",height:"1032"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You have now configured the Webhook URL and this URL is bound to your Slack channel. Gerrit event data posted to this Webhook URL posts a message to the Slack channel."}),"\n",(0,i.jsx)(n.p,{children:"The Webhook URL for this Slack channel and a sample CURL request to post data to the Webhook URL can be found at the bottom of the page. Keep this Webhook URL handy for later use when you in Gerrit. You can use the CURL command on your CLI to verify that the Webhook URL is indeed emptying itself on the configured Slack channel."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(89475).A+"",width:"3584",height:"2080"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(17953).A+"",width:"3584",height:"136"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(68970).A+"",width:"2918",height:"268"})}),"\n",(0,i.jsx)(n.h2,{id:"configure-the-slack-integration-gerrit-plugin",children:"Configure the Slack Integration Gerrit Plugin"}),"\n",(0,i.jsxs)(n.p,{children:["The Gerrit's Slack Integration Plugin is configured via a Gerrit project-specific configuration file. In other words, you must add the Slack channel's name, Webhook URL, and so on to this configuration file, which is the Gerrit project\u2019s ",(0,i.jsx)(n.code,{children:"project.config"})," file on the ",(0,i.jsx)(n.code,{children:"refs/meta/config"})," branch of the project."]}),"\n",(0,i.jsxs)(n.p,{children:["Here's a sample ",(0,i.jsx)(n.code,{children:"project.config"})," file."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'[plugin "slack-integration"]\r\n  channel = gerrit-post-hackathon-test\r\n  enabled = true\r\n  publish-on-patch-set-created = true\r\n  webhookurl = https://hooks.slack.com/services/T02GN6UQX/B020ZN6/vMrGO\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This sample configuration sends notifications for Gerrit events such as ",(0,i.jsx)(n.code,{children:"patch-set-creation"}),", ",(0,i.jsx)(n.code,{children:"Removing WIP"}),", ",(0,i.jsx)(n.code,{children:"Review comment add"})," (including ",(0,i.jsx)(n.code,{children:"Verify"})," and ",(0,i.jsx)(n.code,{children:"Code-Review votes"}),"), ",(0,i.jsx)(n.code,{children:"Reviewer add"}),", and ",(0,i.jsx)(n.code,{children:"Review merge"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"This sample configuration sends no notification when you make a private review public."})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(32927).A+"",width:"3582",height:"822"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(96068).A+"",width:"3536",height:"1122"})}),"\n",(0,i.jsx)(n.p,{children:"Now, if you create a review in this repository, we should see a message from Gerrit in the Slack channel."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(49965).A+"",width:"2920",height:"216"})}),"\n",(0,i.jsx)(n.h2,{id:"points-to-consider",children:"Points to Consider"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ignore"}),": A dotall enabled regular expression pattern\u2014when matches against a commit message\u2014prevents the publishing of ",(0,i.jsx)(n.code,{children:"patchset created"})," event's messages."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ignore-wip-patch-set"}),": Can be set to ",(0,i.jsx)(n.code,{children:"true"})," to prevent Slack notifications regarding a ",(0,i.jsx)(n.code,{children:"work-in-progress"})," change."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ignore-comment-author"}),": Regular expression pattern\u2014when matches against the comment author username\u2014prevents the publishing of ",(0,i.jsx)(n.code,{children:"comment added"})," event's messages."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"publish-on-reviewer-added"}),": Set to ",(0,i.jsx)(n.code,{children:"false"})," to prevent a notification when a reviewer is added to a review."]}),"\n",(0,i.jsxs)(n.li,{children:["Sometimes, it may take time for the Gerrit configuration changes to be applied to the repository. In such a case, force-refresh the repository. For example, here's a CURL request to force-refresh a repository with ",(0,i.jsx)(n.code,{children:"reps1022"})," as its repository ID in TeamForge:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"curl -k -X GET https://gerrit.collab.net/api/refresh/repositories/reps1022\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The CURL option ",(0,i.jsx)(n.code,{children:"-k"})," is added to avoid SSL error. If not CURL, just opening the above repository URL in a browser's address bar can refresh the repository. Opening the repository URL in a browser is the easiest way and if you are using Gerrit over the browser,  you can avoid the SSL error too."]})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},44531:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/app-create-1-c8efd128771a3c8c216004e4ba75c86c.png"},70040:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/app-create-2-22fc0bb2231d73e291ff4033e8ef6f60.png"},54657:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/app-create-3-c5de97bce263ffe958f23c42a429cdb2.png"},77406:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/channel-add-1-1c9476a89a27481947040f262199eb8d.png"},44757:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/channel-add-2-5e565a5b4b476aae2d62e4cd909c870f.png"},59308:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/channel-add-3-f035f52ec9357463843ef2b02eedf259.png"},89475:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/channel-add-4-b9008d97cc245a8e16735b091d9d854e.png"},17953:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/curl-verify-1-dc63a1d185a3bed3ffd9597799bb32df.png"},68970:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/curl-verify-2-9880e95487901828eb987208417e60ca.png"},44222:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/enable-wh-1-58f75bfe96eea363b07b59ab54684eb8.png"},46325:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/enable-wh-2-cc3b5fb65bc8a6ff96b1a8071cd7383c.png"},94060:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/enable-wh-3-a9d1f9d9e0950fb18a2fdddedea299a8.png"},70307:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/enable-wh-4-2b9d9b98e796ada5e8d59183034d2ed2.png"},6202:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/enable-wh-5-ece2f759fbf0b427c9edb377c6692e0b.png"},32927:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gerrit-config-1-4af2a0c0742e9d9c6c30b2dcfe2441d6.png"},96068:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gerrit-config-2-2fdaf6c0fa07efb07556bf407c50219b.png"},49965:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/gerrit-config-3-8f3e39048a4e962abd13e89c26060cd4.png"},72976:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/sign-in-1-e4f828f5bc928cca68b8fa1d90852b07.png"},44267:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/sign-in-2-9a381b36f7053a93fff90375b5734b94.png"},23138:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/sign-in-3-3fd1c011aba106ba6ba196882e89206b.png"},27389:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/sign-in-4-a865b550e08ebce22c792b7bde9bce80.png"},43023:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var i=t(63696);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);